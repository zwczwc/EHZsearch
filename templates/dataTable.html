{% load staticfiles %}
<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>查询用户</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="{% static 'favicon.ico' %}"> <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/font-awesome.css' %}" rel="stylesheet">
    <link href="{% static 'css/plugins/bootstrap-table/bootstrap-table.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">


</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
        <!-- Panel Other -->
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>招聘信息</h5>
                <!-- <div class="ibox-tools">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-wrench"></i>
                    </a>
                    <a class="close-link">
                        <i class="fa fa-times"></i>
                    </a>
                </div> -->
            </div>
            <div class="ibox-content">
                <div class="row row-lg">
                    <div class="col-sm-12">
                        <!-- Example Events -->
                        <div class="example-wrap">
                            <div class="example">
                                <div class="btn-group hidden-xs" id="exampleTableEventsToolbar" role="group">
                                    <form role="form" class="form-inline">
                                        <div class="form-group">
                                            <label for="city" class="sr-only">标题</label>
                                            <input type="text" placeholder="标题" id="city"
                                                   class="form-control">
                                        </div>
                                        <div class="form-group form-group-sm">
                                            <label for="job_experience" class="sr-only">时间点</label>
                                            <select id="job_experience" class="form-control">
                                                <option value="">时间点</option>
                                                <option value="不限">不限</option>
                                                <option value="无经验">无经验</option>
                                                <option value="1年以下">1年以下</option>
                                                <option value="1-3年">1-3年</option>
                                                <option value="3-5年">3-5年</option>
                                                <option value="5-10年">5-10年</option>
                                                <option value="10年以上">10年以上</option>
                                            </select>
                                        </div>
                                        <div class="form-group form-group-sm">
                                            <label for="education" class="sr-only">文章类型</label>
                                            <select type="text" id="education"
                                                   class="form-control">
                                                <option value="">来源</option>
                                                <option value="新浪">新浪</option>
                                                <option value="36氪">36氪</option>
                                            </select>
                                        </div>
                                        <div class="form-group form-group-sm">

                                            <button class="btn btn-default" type="button" class="form-control" onclick="btn_query_click()">查询</button>
                                        </div>
                                    </form>
                                </div>
                                <table id="exampleTableEvents" data-height="450" data-mobile-responsive="true">
                                </table>
                            </div>
                        </div>
                        <!-- End Example Events -->
                    </div>
                </div>
            </div>
        </div>
        <!-- End Panel Other -->
    </div>
    <div class="modal inmodal" id="myModal2" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content animated flipInY">
                    <div class="modal-header">
                        <h4 class="modal-title">公司信息</h4>
                    </div>
                    <div class="modal-body row" style="margin: 0;position: relative;">
                        <div class="col-md-5">
                            <img id="companyImg" src="http://img09.zhaopin.com/2012/other/mobile/mi/companyLogo/03/default.png" width="200" height="200" style="margin: 0 auto;">
                        </div>
                        <div class="col-md-7">
                             <a id="companyName" style="font-size: 24px;margin-top:20px;display: block;" href="javascript:">成都众慧贸易有限公司</a><br>
                             <span id="companyIndu" style="font-size: 18px;margin-top:20px;display: block;">设计/艺术</span><br>
                             <span id="companyScale" style="font-size: 18px;margin-top:20px;display: block;">20人以下</span><br>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
    </div>
    <!-- 全局js -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>

    <!-- 自定义js -->
    <script src="{% static 'js/content.js' %}"></script>


    <!-- Bootstrap table -->
    <script src="{% static 'js/plugins/bootstrap-table/bootstrap-table.min.js' %}"></script>
    <script src="{% static 'js/plugins/bootstrap-table/bootstrap-table-mobile.min.js' %}"></script>
    <script src="{% static 'js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js' %}"></script>

    <!-- Peity -->
    <script type="text/javascript">

		$(function(){
			$('#exampleTableEvents').bootstrapTable({
			      url: "/job/getNewsInfo",
			      method:"get",
			      search: false,
			      cache: false,
			      clickToSelect:true,
			      pagination: true,
			      showRefresh: true,
			      showToggle: true,
			      showColumns: true,
			      pageNumber: 1,
			      pageSize: 10,
		          pageList: [10, 25, 50, 100],
			      sidePagination: 'server',
			      iconSize: 'outline',
			      idField: "devId",
			      toolbar: '#exampleTableEventsToolbar',
			      columns: [{
	                    field: 'state',
	                    radio: true,
	                },{
	                    field: 'title',
	                    title: '标题',
	                    align:"center",
	                    halign:"center",
                        formatter:yongHuBangDing
	                }, {
	                    field: 'link',
	                    title: '链接',
	                    align:"center",
	                    halign:"center"
	                },{
	                    field: 'source',
	                    title: '来源',
	                    align:"center",
	                    halign:"center"
	                },{
	                    field: 'time',
	                    title: '时间',
	                    align:"center",
	                    halign:"center"
	                },{
	                    field: 'abstract',
	                    title: '摘要',
	                    align:"center",
	                    halign:"center"
	                }],
		          queryParams : function (params) {
		            //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
		            var temp = {
		                rows: params.limit,                         //页面大小
		                page: (params.offset / params.limit) + 1,   //页码

                        title:$("#title").val(),
                        link:$("#link").val(),
                        source:$("#source").val(),
                        time:$("#time").val(),
                        abstract:$("#abstract").val()
		            };
		            return temp;
		        },
			      icons: {
			        refresh: 'glyphicon-repeat',
			        toggle: 'glyphicon-list-alt',
			        columns: 'glyphicon-list'
			      }
			    });
		});
        function yongHuBangDing(value,row,index){
				return "<a href='javascript:;' class='btn btn-xs green' onclick=\"checkCompany('" + row.number_id + "')\">"+value+"</a>";
		}
       function btn_query_click(){
           $('#exampleTableEvents').bootstrapTable('selectPage', 1);
           $('#exampleTableEvents').bootstrapTable('refresh');
       }

       function checkCompany(numberId){
                $.ajax({
                    async : true,    //表示请求是否异步处理
                    type : "get",    //请求类型
                    url : "/job/companyInfo",//请求的 URL地址
                    dataType : "json",//返回的数据类型
                    data:{"numberId":numberId},
                    success: function (datas){
                        console.log(datas);
                        document.getElementById("companyImg").src = datas[0].logo;
                        document.getElementById("companyName").href = datas[0].website;
                        document.getElementById("companyName").innerHTML  = datas[0].company;
                        document.getElementById("companyIndu").innerHTML  = datas[0].industry;
                        document.getElementById("companyScale").innerHTML  = datas[0].scale;

                        $("#myModal2").modal({
                            backdrop: "static", // 相当于data-backdrop
                            keyboard: false, // 相当于data-keyboard
                            show: true  // 相当于data-show
                        });
                    },
                    error:function (data) {

                    }
                });
       }

    </script>
</body>
</html>